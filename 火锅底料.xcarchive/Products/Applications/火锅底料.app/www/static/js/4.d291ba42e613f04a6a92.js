webpackJsonp([4],{"+9dI":function(t,n,e){t.exports=e.p+"static/img/1.cba52df.png"},"+Jdy":function(t,n,e){t.exports=e.p+"static/img/4.5db301c.png"},"2ZEU":function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=e("lC5x"),o=e.n(i),a=e("J0Oq"),s=e.n(a),r=(e("CtzY"),function(t){if(""==t)return!0;return new RegExp("^[ ]+$").test(t)}),l={name:"login",data:function(){var t=this;return{clientHeight:document.documentElement.clientHeight,loginIntroDialog:{show:!1,intro:[' <div class="mt-1"  >  <li >用户名默认为学号或者姓名全拼</li> <li>密码为自定义的6-18位密码</li> <li><strong>第一次使用邮箱需要激活，激活步骤请继续看下一张卡片</strong></li></div>','    <div class="mt-1"> <li>学校选择<strong>四川大学学生邮箱</strong></li> <li>默认密码为stu+身份证后六位</li> </div>',' <div class="mt-3"> <li>请绑定常用手机</li> </div>','   <div class="mt-3"> <li>设置密码后点击激活即可</li> </div>'],introImages:["../../static/images/loginIntro/1.png","../../static/images/loginIntro/2.png","../../static/images/loginIntro/3.png","../../static/images/loginIntro/4.png"]},loginProblem:{show:!1},ipProblemDialog:!1,email:"@stu.scu.edu.cn",code:"",oneMinuteInterval:!1,cnt:20,snackbar:{show:!1,message:"",type:"error"},filter:function(n){console.log(t.whiteList);return!(!/^([A-Za-z0-9_\-\.\u4e00-\u9fa5])+@stu.scu.edu.cn/.test(n)&&!t.whiteList.includes(n))||"邮箱不合法"},whiteList:[]}},created:function(){var t=this;t.$request("get","/user/getWhiteList",{},{}).then(function(n){t.whiteList=n.data.map(function(t){return t.email})})},mounted:function(){var t=this;window.onresize=function(){t.clientHeight=document.documentElement.clientHeight}},methods:{showSnackbarInLogin:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"error";this.snackbar={show:!0,message:t.message||t,type:n}},registerWithEmail:function(){var t=this,n=this;r(this.code)?n.showSnackbarInLogin("验证码不能为空"):n.$request("post","/user/registerWithEmail",{},{email:n.email,code:n.code}).then(function(e){n.showSnackbarInLogin(e,"ok"),localStorage.setItem("token",e.data),setTimeout(s()(o.a.mark(function e(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n.$router.replace("/main/index");case 1:case"end":return t.stop()}},e,t)})),1e3)}).catch(function(t){n.showSnackbarInLogin(t)})},getCode:function(){var t=this,n=this;if("邮箱不合法"!=this.filter(this.email)){n.$request("post","/user/getCode",{},{email:this.email}).then(function(t){n.showSnackbarInLogin(t||"验证码已发送到邮箱,请查收","ok")}).catch(function(t){n.showSnackbarInLogin(t)}),this.oneMinuteInterval=!0;var e=setInterval(function(){t.cnt--,0==t.cnt&&(t.oneMinuteInterval=!1,clearInterval(e),t.cnt=20)},1e3)}else n.showSnackbarInLogin("邮箱不合法")},toSCUMail:function(){window.open("http://mail.stu.scu.edu.cn/coremail/index.jsp?nodetect=true","_system",{})}},watch:{ipProblemDialog:function(t){this.$store.change_dialog(t,"ipProblemDialog")},"$store.state.dialog":function(t){"ipProblemDialog"==this.$store.state.dialogName&&(this.ipProblemDialog=t)}}},c={render:function(){var t=this,n=t.$createElement,i=t._self._c||n;return i("v-container",{staticClass:"d-flex justify-center align-center",attrs:{"fill-height":""}},[i("v-card",{attrs:{flat:""}},[i("v-text-field",{attrs:{label:"输入川大学生邮箱","prepend-icon":"mdi-email-box",rules:[t.filter]},scopedSlots:t._u([{key:"append",fn:function(){return[i("v-btn",{staticClass:"mb-1",attrs:{color:"primary",small:"",text:""},on:{click:function(n){n.stopPropagation(),t.loginIntroDialog.show=!0}}},[i("span",[t._v("邮箱登陆指南")])])]},proxy:!0}]),model:{value:t.email,callback:function(n){t.email=n},expression:"email"}}),t._v(" "),i("div",{staticClass:"d-flex "},[i("v-text-field",{attrs:{label:"输入验证码","prepend-icon":"mdi-barcode"},scopedSlots:t._u([{key:"append",fn:function(){return[t.oneMinuteInterval?t._e():i("v-btn",{staticClass:"pb-2",attrs:{color:"primary",small:"",text:""},on:{click:t.getCode}},[t._v("点击获取验证码")]),t._v(" "),t.oneMinuteInterval?i("v-btn",{staticClass:"pb-2",attrs:{color:"primary",small:"",text:"",disabled:""}},[t._v(t._s(t.cnt)+"秒后重发")]):t._e()]},proxy:!0}]),model:{value:t.code,callback:function(n){t.code=n},expression:"code"}}),t._v(" "),i("v-btn",{staticClass:"mt-4",attrs:{color:"primary",icon:"",small:""},on:{click:function(n){t.loginProblem.show=!0}}},[i("v-icon",[t._v("mdi-help-circle-outline")])],1)],1),t._v(" "),i("v-card-actions",[i("v-spacer"),t._v(" "),i("v-btn",{attrs:{color:"primary",outlined:""}},[i("span",{staticClass:"text_xsmall",on:{click:t.toSCUMail}},[t._v("前往四川大学邮箱")])]),t._v(" "),i("v-btn",{attrs:{color:"primary"},on:{click:t.registerWithEmail}},[i("v-icon",{attrs:{right:""}},[t._v("mdi-arrow-right-bold-circle")]),t._v(" "),i("span",{staticClass:"pr-2"},[t._v("登陆")])],1)],1)],1),t._v(" "),i("v-dialog",{attrs:{scrollable:"",overlay:!1,"max-width":"500px",transition:"dialog-transition",dark:""},model:{value:t.loginIntroDialog.show,callback:function(n){t.$set(t.loginIntroDialog,"show",n)},expression:"loginIntroDialog.show"}},[i("v-card",{staticStyle:{"background-color":"#363636"}},[i("v-card-title",[i("v-icon",[t._v("mdi-login")]),t._v(" "),i("span",{staticClass:"ml-1"},[t._v("邮箱登陆指南")])],1),t._v(" "),i("v-divider"),t._v(" "),i("v-card-text",{staticClass:"mt-1"},[i("v-carousel",{attrs:{cycle:"",height:"400","hide-delimiter-background":"","show-arrows-on-hover":""}},t._l(t.loginIntroDialog.intro,function(n,o){return i("v-carousel-item",{key:o},[i("v-img",{attrs:{src:e("8vIY")("./"+(o+1)+".png"),contain:"","max-height":"300px"}}),t._v(" "),i("div",{domProps:{innerHTML:t._s(n)}})],1)}),1)],1)],1)],1),t._v(" "),i("v-dialog",{attrs:{scrollable:"",overlay:!1,"max-width":"500px",transition:"dialog-transition",dark:""},model:{value:t.loginProblem.show,callback:function(n){t.$set(t.loginProblem,"show",n)},expression:"loginProblem.show"}},[i("v-card",{staticStyle:{"background-color":"#363636"}},[i("v-card-title",[i("v-icon",[t._v("mdi-help-circle-outline")]),t._v(" "),i("span",{staticClass:"ml-2"},[t._v("登陆常见问题")])],1),t._v(" "),i("v-divider"),t._v(" "),i("v-card-text",{staticClass:"mt-1"},[i("div",[i("li",[i("strong",[t._v("Q：收不到验证码怎么办？")])]),t._v(" "),i("span",[t._v("A：请检查邮箱名是否输入正确，如果正确，请多刷新几次，检查邮件垃圾箱中是否有验证码。")]),t._v(" "),i("li",[i("strong",[t._v("Q：邮箱无法登陆？")])]),t._v(" "),i("span",[t._v("A：请确认四川大学邮箱是否激活了，如果没有激活，请按照“邮箱输入栏”中的“邮箱登陆指南”步骤激活邮箱")])])])],1)],1),t._v(" "),i("v-snackbar",{attrs:{color:"ok"==t.snackbar.type?"red lighten-2":"grey darken-3",timeout:1100,centered:""},model:{value:t.snackbar.show,callback:function(n){t.$set(t.snackbar,"show",n)},expression:"snackbar.show"}},[t._v("\n    "+t._s(t.snackbar.message)+"\n  ")])],1)},staticRenderFns:[]};var u=e("C7Lr")(l,c,!1,function(t){e("5f7+")},null,null);n.default=u.exports},"5f7+":function(t,n){},"8vIY":function(t,n,e){var i={"./1.png":"+9dI","./2.png":"uKqF","./3.png":"FXn6","./4.png":"+Jdy"};function o(t){return e(a(t))}function a(t){var n=i[t];if(!(n+1))throw new Error("Cannot find module '"+t+"'.");return n}o.keys=function(){return Object.keys(i)},o.resolve=a,t.exports=o,o.id="8vIY"},FXn6:function(t,n,e){t.exports=e.p+"static/img/3.2d04cb8.png"},uKqF:function(t,n,e){t.exports=e.p+"static/img/2.fc6016b.png"}});
//# sourceMappingURL=4.d291ba42e613f04a6a92.js.map